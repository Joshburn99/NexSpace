You’ve finished the queue. Run a full verification + surgical hardening for this Replit app (Express + Passport sessions, Drizzle + SQL scripts). Make changes as needed and show diffs.

	1.	Server & sessions

	•	Confirm app.listen(process.env.PORT || 5000, '0.0.0.0') and app.set('trust proxy', 1). Fix if needed; paste diff.
	•	Show final express-session config (cookie secure, sameSite, httpOnly, maxAge) appropriate for Replit (HTTPS proxy). If FE/BE are same-origin use sameSite:'lax', else sameSite:'none' with secure:true.

	2.	CORS + credentials

	•	Set origin to the current public Replit URL (not “*”), credentials:true. Paste final CORS block and the computed origin.

	3.	Env integrity

	•	Inventory all process.env.* and import.meta.env.VITE_* usages → table: name | files | required? | default.
	•	Create server/config/env.ts with a schema-based validator; fail fast with a clear error message if required keys are missing. Wire it into server bootstrap.

	4.	DB state & seeds

	•	Run migrations quietly; report count and latest migration.
	•	Run seed idempotently; prove row counts don’t double. Show counts for Users, Facilities, Staff, Shifts, Teams, Permissions, RolePermissions, Session.
	•	Ensure indices/uniques exist: users.username, roles.name, role_permissions(role_id,permission_id). Add if missing (migration + diff).

	5.	Auth endpoints sanity

	•	Show implementations for POST /api/auth/login, GET /api/auth/me, POST /api/auth/logout.
	•	Provide two curl transcripts (401 without cookies, 200 with cookies). Sanitize any sensitive values.

	6.	EnhancedStaffPage fix confirmation

	•	State the root cause of the previous crash and paste the exact code diff that fixed it.
	•	Confirm loading and empty states exist; list the component(s) touched.

	7.	Docs single source of truth

	•	Make README canonical. Update RUNBOOK.md to be a short pointer to README.
	•	Ensure /api-docs is accurate and linked in README.

	8.	Safety & cleanup

	•	Add a lightweight session sweeper (scheduled interval) to delete expired sessions; ensure index on expires.
	•	Ensure .gitignore includes .env, backups/, any secret artifacts.
	•	Rotate the dev admin password in seed to a non-trivial value IF the repo is public; document how to override via env.

	9.	Commit & concise changelog

	•	Commit with: “Verify & harden: bind/proxy, sessions/CORS, env validation, indices, docs”.
	•	Output a bullet changelog (file → why). If anything fails, fix it and re-run before responding.